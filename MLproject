# ML Project:
#
# The following file specifies the project as a reproducible
# MLFlow project, which allow us to parametrize the inputs on
# consecutive runs and to track results using a tracking server.
#
# It has been created following this guide:
# https://www.mlflow.org/docs/latest/projects.html

name: madminer-workflow-ml

entry_points:

  train:
    command: """
      python3 {project_path}/code/train.py \
        --alpha {alpha} \
        --batch_size {batch_size} \
        --num_epochs {num_epochs} \
        --valid_split {valid_split} \
        --output_path {output_folder} \
        --samples_path {train_folder}
      """
    parameters:
      project_path: {type: path}
      output_folder: {type: path}
      train_folder: {type: path}
      alpha: {type: float, default: 10.0}
      batch_size: {type: float, default: 100}
      num_epochs: {type: float, default: 2}
      valid_split: {type: float, default: 0.3}

  eval:
    command: "python3 {project_path}/code/evaluation.py {input_file} {model_dir} {data_file} {output_dir}"
    parameters:
      project_path: path
      input_file: path
      model_dir: path
      data_file: path
      output_dir: path
